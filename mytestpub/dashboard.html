<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>BTX.ONE – Member Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root{
      --accent-blue:#38bdf8;
      --accent-green:#22c55e;
      --accent-bg:#020617;
      --card-bg:rgba(6,18,38,.98);
      --card-border:rgba(148,163,184,.55);
    }

    *{box-sizing:border-box;margin:0;padding:0;font-family:system-ui,-apple-system,"Segoe UI",sans-serif}
    body{
      min-height:100vh;
      background:
        radial-gradient(circle at top,rgba(56,189,248,.25),transparent 55%),
        radial-gradient(circle at 80% 0,rgba(34,197,94,.24),transparent 60%),
        radial-gradient(circle at bottom,rgba(15,23,42,1),#020617 65%);
      color:#e5f0ff;
      padding:16px;
    }
    a{color:var(--accent-blue);text-decoration:none}

    .shell{max-width:1100px;margin:0 auto;}

    /* HEADER */
    .dash-header{
      display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;
    }
    .brand{display:flex;align-items:center;gap:10px;}
    .brand-logo-img{
      width:52px;height:52px;border-radius:999px;object-fit:cover;background:#020617;
      box-shadow:0 0 0 2px rgba(56,189,248,.9),0 0 26px rgba(56,189,248,.9);
    }
    .brand-title h1{font-size:18px;letter-spacing:.22em;text-transform:uppercase;}
    .brand-title p{font-size:11px;color:#9ca3af;margin-top:2px;}

    .header-actions{display:flex;align-items:center;gap:8px;font-size:12px;position:relative;}
    .btn-small{
      border:none;border-radius:999px;padding:7px 14px;font-size:11px;
      text-transform:uppercase;letter-spacing:.16em;cursor:pointer;
      background:linear-gradient(135deg,var(--accent-blue),var(--accent-green));
      color:#020617;box-shadow:0 14px 32px rgba(56,189,248,.85);
    }
    .btn-outline-small{
      border-radius:999px;padding:6px 12px;font-size:11px;text-transform:uppercase;
      letter-spacing:.16em;border:1px solid rgba(148,163,184,.7);
      background:rgba(15,23,42,.9);color:#e5e7eb;cursor:pointer;
    }
    .menu-dot{width:34px;text-align:center;padding:6px 0;font-weight:900;}
    .menu-dropdown{
      position:absolute;right:0;top:115%;
      background:var(--card-bg);border-radius:12px;
      box-shadow:0 18px 40px rgba(0,0,0,.9);
      border:1px solid var(--card-border);
      padding:6px;min-width:190px;display:none;z-index:30;
    }
    .menu-dropdown button{
      width:100%;border:none;background:transparent;color:#e5f0ff;font-size:12px;
      padding:7px 10px;text-align:left;border-radius:8px;cursor:pointer;
    }
    .menu-dropdown button:hover{background:rgba(30,64,175,.9);}

    /* MAIN CARD */
    .dash-card-main{
      position:relative;border-radius:26px;padding:12px 18px 18px;
      background:linear-gradient(135deg,rgba(15,23,42,.98),rgba(15,23,42,.99));
      box-shadow:0 0 0 2px rgba(56,189,248,.65),0 26px 70px rgba(0,0,0,.95);
      overflow:hidden;
    }
    .dash-glow{
      position:absolute;inset:-120px;
      background:
        radial-gradient(circle at -10% -10%,rgba(56,189,248,.4),transparent 60%),
        radial-gradient(circle at 110% 110%,rgba(34,197,94,.4),transparent 55%);
      opacity:.8;pointer-events:none;
    }
    .dash-inner{position:relative;z-index:1;}

    /* NOTICE */
    .notice-wrap{
      margin:4px 0 10px;border-radius:999px;background:rgba(15,23,42,.96);
      border:1px solid rgba(250,204,21,.7);overflow:hidden;padding:3px 0;
    }
    .notice-text{
      display:inline-block;padding:3px 16px;white-space:nowrap;font-size:11px;color:#facc15;
      animation:ticker 35s linear infinite alternate;
    }
    @keyframes ticker{0%{transform:translateX(-100%);}100%{transform:translateX(100%);} }

    /* WELCOME */
    .welcome-row{
      display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap;margin-bottom:10px;
    }
    .welcome-main{flex:1;min-width:220px;}
    .welcome-main h2{font-size:20px;margin-bottom:4px;}
    .welcome-main span{color:#a5b4fc;font-size:13px;}
    .badge-role{
      display:inline-flex;align-items:center;gap:4px;border-radius:999px;
      padding:3px 10px;font-size:10px;margin-top:6px;
      border:1px solid rgba(74,222,128,.7);background:rgba(22,163,74,.2);color:#bbf7d0;
    }
    .badge-member{border-color:rgba(56,189,248,.7);background:rgba(37,99,235,.3);color:#bae6fd;}
    .member-status{margin-top:4px;font-size:11px;color:#bbf7d0;}
    .welcome-right{min-width:220px;max-width:280px;font-size:12px;color:#cbd5f5;}
    .welcome-right div{margin-bottom:2px;}

    /* SMALL TOP NOTES */
    .mini-notes{
      display:flex;gap:8px;flex-wrap:wrap;margin:6px 0 10px;
    }
    .mini-pill{
      border:1px solid rgba(148,163,184,.55);
      background:rgba(2,6,23,.55);
      border-radius:999px;
      padding:6px 10px;
      font-size:11px;color:#cbd5f5;
    }

    /* LIVE SNAPSHOT */
    .live-snapshot{
      display:flex;flex-direction:column;gap:6px;border-radius:22px;padding:12px 14px;
      background:radial-gradient(circle at 0 0,#020617,#020617 70%);
      box-shadow:0 0 0 1px var(--card-border),0 22px 50px rgba(15,23,42,.96);
      margin-bottom:12px;
    }
    .live-snapshot-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px;}
    .live-snapshot-title{
      font-size:13px;letter-spacing:.14em;text-transform:uppercase;color:#e5f0ff;
    }
    .live-snapshot-badge{
      font-size:10px;padding:3px 8px;border-radius:999px;
      border:1px solid rgba(52,211,153,.8);color:#bbf7d0;background:rgba(6,95,70,.4);
    }
    .live-snapshot-row{display:flex;justify-content:space-between;gap:8px;font-size:12px;}
    .live-snapshot-row span:first-child{color:#9ca3af;}
    .live-snapshot-row span.value{color:var(--accent-green);font-weight:600;}

    /* SUMMARY GRID */
    .summary-grid{
      display:grid;grid-template-columns:repeat(auto-fit,minmax(170px,1fr));
      gap:10px;margin-bottom:14px;
    }
    .summary-card{
      border-radius:18px;padding:10px 12px;background:var(--card-bg);
      box-shadow:0 0 0 1px var(--card-border),0 14px 32px rgba(15,23,42,.95);
      font-size:12px;transition:transform .15s, box-shadow .15s, border-color .15s;
    }
    .summary-card p{color:#9ca3af;margin-bottom:3px;}
    .summary-card h3{font-size:18px;font-weight:700;}
    .summary-tag{font-size:10px;text-transform:uppercase;letter-spacing:.12em;color:#a5b4fc;margin-top:2px;}
    .summary-card:hover{
      transform:translateY(-4px) scale(1.02);
      box-shadow:0 0 0 1px rgba(56,189,248,.9),0 18px 40px rgba(15,23,42,1);
    }
    .gold-border{box-shadow:0 0 0 1px rgba(250,204,21,.8),0 18px 40px rgba(15,23,42,1);}

    /* REFERRAL */
    .ref-card{
      border-radius:18px;padding:12px;background:var(--card-bg);
      box-shadow:0 0 0 1px rgba(56,189,248,.55),0 18px 40px rgba(15,23,42,.96);
      margin-bottom:12px;
    }
    .ref-header{display:flex;justify-content:space-between;align-items:center;gap:8px;margin-bottom:6px;}
    .ref-header h3{font-size:14px;}
    .ref-header span{font-size:11px;color:#9ca3af;}
    .ref-body{display:flex;gap:8px;flex-wrap:wrap;}
    .ref-input{flex:1;min-width:200px;}
    .ref-input input{
      width:100%;padding:8px 10px;border-radius:999px;border:none;outline:none;
      background:rgba(15,23,42,1);color:#e5f0ff;font-size:12px;
      box-shadow:0 0 0 1px rgba(148,163,184,.7);
    }
    .ref-btn{
      border:none;border-radius:999px;padding:8px 14px;font-size:11px;
      text-transform:uppercase;letter-spacing:.14em;cursor:pointer;
      background:linear-gradient(135deg,var(--accent-blue),var(--accent-green));
      color:#020617;box-shadow:0 14px 34px rgba(59,130,246,.9);
      white-space:nowrap;
    }

    /* INFO GRID */
    .info-grid{
      display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
      gap:10px;margin-bottom:14px;
    }
    .info-card{
      border-radius:16px;padding:10px 12px;background:var(--card-bg);
      box-shadow:0 0 0 1px var(--card-border),0 14px 30px rgba(15,23,42,.96);
      font-size:12px;
    }
    .info-card h4{font-size:13px;margin-bottom:6px;}
    .info-row{display:flex;justify-content:space-between;margin-bottom:2px;}
    .info-row span:first-child{color:#9ca3af;}

    /* BAROMETER */
    .bar-progress{
      width:100%;height:16px;border-radius:999px;background:#020617;
      box-shadow:0 0 0 1px rgba(148,163,184,.7) inset;overflow:hidden;
    }
    .bar-progress-inner{
      height:100%;border-radius:999px;background:linear-gradient(90deg,var(--accent-blue),var(--accent-green));
      text-align:center;font-size:10px;line-height:16px;color:#020617;white-space:nowrap;
    }
    .bar-invest-grid{display:flex;gap:6px;margin:6px 0 8px;}
    .mini-invest-card{
      flex:1;border-radius:10px;padding:4px 6px;background:radial-gradient(circle at top,#020617,#020617 65%);
      box-shadow:0 0 0 1px rgba(148,163,184,.6),0 10px 20px rgba(15,23,42,.9);
      font-size:11px;
    }
    .mini-invest-card p{margin-bottom:1px;color:#9ca3af;font-size:10px;}
    .mini-invest-card h5{font-size:13px;}

    .barometer-layout{display:flex;gap:8px;align-items:flex-end;margin-top:4px;}
    .barometer-left{flex:1.6;}
    .bar-vertical-box{
      flex:0.8;display:flex;flex-direction:column;align-items:center;
      font-size:10px;color:#9ca3af;gap:4px;
    }
    .bar-vertical{
      width:26px;height:120px;border-radius:999px;background:linear-gradient(180deg,#020617,#020617 40%);
      box-shadow:0 0 0 1px rgba(148,163,184,.65) inset,0 12px 25px rgba(15,23,42,.9);
      padding:3px;display:flex;align-items:flex-end;overflow:hidden;
    }
    .bar-vertical-inner{
      width:100%;border-radius:999px;background:linear-gradient(180deg,var(--accent-blue),var(--accent-green));
      box-shadow:0 0 12px rgba(248,250,252,.35);
      display:flex;align-items:center;justify-content:center;font-size:8px;color:#020617;
    }

    /* CHARTS */
    .charts-grid{
      display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
      gap:12px;margin-bottom:6px;
    }
    .chart-card{
      border-radius:18px;padding:10px 12px 14px;background:var(--card-bg);
      box-shadow:0 0 0 1px var(--card-border),0 18px 40px rgba(15,23,42,.96);
    }
    .chart-card h4{font-size:13px;margin-bottom:4px;}
    canvas{max-width:100%;}
    .note{margin-top:6px;font-size:10px;color:#9ca3af;}

    /* small copy button */
    .copy-wrap{display:inline-flex;align-items:center;gap:4px;}
    .copy-btn{
      border:none;border-radius:999px;padding:3px 7px;font-size:10px;text-transform:uppercase;
      letter-spacing:.12em;cursor:pointer;background:#0f172a;color:#e5e7eb;border:1px solid #475569;
    }

    /* TRANSACTION HISTORY */
    .txn-card{
      border-radius:18px;padding:10px 12px;background:rgba(15,23,42,.96);
      box-shadow:0 0 0 1px rgba(148,163,184,.5);
      margin-top:10px;font-size:12px;
    }
    .txn-header-row{
      display:flex;justify-content:space-between;align-items:center;gap:8px;margin-bottom:6px;flex-wrap:wrap;
    }
    .txn-header-row h4{
      font-size:13px;letter-spacing:.14em;text-transform:uppercase;color:#e5f0ff;
    }
    .txn-filter-row{display:flex;gap:8px;flex-wrap:wrap;}
    .txn-filter-row select,.txn-filter-row input{
      border-radius:999px;border:1px solid rgba(148,163,184,.6);
      background:#020617;color:#e5f0ff;padding:6px 10px;font-size:11px;outline:none;min-width:120px;
    }
    .txn-table{width:100%;border-collapse:collapse;font-size:11px;margin-top:8px;}
    .txn-table th,.txn-table td{
      padding:6px;border-bottom:1px solid rgba(30,64,175,.6);white-space:nowrap;
    }
    .txn-table th{
      font-size:10px;text-transform:uppercase;letter-spacing:.12em;color:#9ca3af;
    }

    @media(max-width:640px){
      body{padding:10px;}
      .dash-header{flex-direction:column;align-items:flex-start;gap:8px;}
    }
  </style>
</head>

<body>
  <div class="shell">
    <!-- HEADER -->
    <header class="dash-header">
      <div class="brand">
        <img src="images/logo.png" alt="BTX Logo" class="brand-logo-img" />
        <div class="brand-title">
          <h1 id="siteTitleHeading">BTX.ONE</h1>
          <p id="dashTitleText">BLOCKCHAIN TRADE EXCHANGE</p>
        </div>
      </div>

      <div class="header-actions">
        <button id="adminBtn" class="btn-outline-small" style="display:none;" onclick="goAdmin()">Admin</button>
        <button class="btn-outline-small" onclick="goHome()">Home</button>
        <button class="btn-small" onclick="logout()">Logout</button>

        <button class="btn-outline-small menu-dot" id="menuToggle">⋮</button>
        <div class="menu-dropdown" id="menuDropdown">
          <button type="button" onclick="goProfile()">Profile</button>
          <button type="button" onclick="goGenealogy()">Genealogy / Team</button>
          <button type="button" onclick="goBTree()">Genealogy (B-Tree)</button>
          <button type="button" onclick="goIncomeHistory()">Income History</button>
          <button type="button" onclick="goTxnHistory()">Transaction History</button>
        </div>
      </div>
    </header>

    <!-- MAIN CARD -->
    <section class="dash-card-main">
      <div class="dash-glow"></div>
      <div class="dash-inner">

        <!-- NOTICE -->
        <div class="notice-wrap">
          <div class="notice-text" id="noticeText">
            ⚠ Dashboard: all income / ROI / bonuses for your bright life – instant withdraw USDT to your wallet.
          </div>
        </div>

        <!-- WELCOME -->
        <div class="welcome-row">
          <div class="welcome-main">
            <h2 id="welcomeName">Welcome, Member</h2>
            <span id="welcomeUser">@username</span>
            <div id="roleBadge"></div>
            <div class="member-status" id="memberStatus">Free Member</div>
            <div class="member-status" id="rankStatusText">Rank: -</div>
          </div>
          <div class="welcome-right">
            <div id="infoEmail"></div>
            <div id="infoCountry"></div>
            <div id="infoMobile"></div>
            <div id="infoSponsor"></div>
          </div>
        </div>

        <!-- SMALL NOTES (moved up, compact) -->
        <div class="mini-notes">
          <div class="mini-pill" id="roiNoteTextMini">ROI: -</div>
          <div class="mini-pill" id="capNoteTextMini">Capping: -</div>
          <div class="mini-pill">Support: <span id="supportEmailText">support@example.com</span></div>
          <div class="mini-pill">Telegram: <a id="teleLink" href="#" target="_blank">Telegram group</a></div>
        </div>

        <!-- LIVE ACCOUNT SNAPSHOT -->
        <div class="live-snapshot">
          <div class="live-snapshot-header">
            <div class="live-snapshot-title">Live Account Snapshot</div>
            <div class="live-snapshot-badge" id="liveDataBadge">Local data (demo)</div>
          </div>

          <div class="live-snapshot-row"><span>Current Balance</span><span class="value" id="liveCurrentBal">$0.00</span></div>
          <div class="live-snapshot-row"><span>Current Earning</span><span class="value" id="liveCurrentEarn">$0.00</span></div>
          <div class="live-snapshot-row"><span>Self Investment</span><span class="value" id="liveSelfInv">$0.00</span></div>
          <div class="live-snapshot-row"><span>Team Size</span><span class="value" id="liveTeamSize">0 members</span></div>
          <div class="live-snapshot-row"><span>Total Earnings</span><span class="value" id="liveTotalEarn">$0.00</span></div>
        </div>

        <!-- SUMMARY CARDS -->
        <div class="summary-grid">
          <div class="summary-card"><p>Add Fund Balance</p><h3 id="sumAddBalance">$0.00</h3><div class="summary-tag">For ID activation / package</div></div>
          <div class="summary-card"><p>Current Earning</p><h3 id="sumCurrentEarn">$0.00</h3><div class="summary-tag">Earning wallet (all)</div></div>
          <div class="summary-card"><p>Personal Investment</p><h3 id="sumSelf">$0.00</h3><div class="summary-tag">Your deposit</div></div>
          <div class="summary-card"><p>Team Investment</p><h3 id="sumTeamInv">$0.00</h3><div class="summary-tag">Total team volume</div></div>
          <div class="summary-card"><p>Sponsor Bonus</p><h3 id="sumDirect">$0.00</h3><div class="summary-tag">Direct referral</div></div>
          <div class="summary-card"><p>Generation Bonus</p><h3 id="sumGen">$0.00</h3><div class="summary-tag">Level income</div></div>
          <div class="summary-card"><p>Daily Profit (ROI)</p><h3 id="sumROI">$0.00</h3><div class="summary-tag">Per-day ROI only</div></div>
          <div class="summary-card"><p>Rank Bonus</p><h3 id="sumRank">$0.00</h3><div class="summary-tag">Rank based bonus</div></div>
          <div class="summary-card"><p>Global Sales Bonus</p><h3 id="sumGlobal">$0.00</h3><div class="summary-tag">Company global pool</div></div>
          <div class="summary-card"><p>Gift Voucher</p><h3 id="sumGift">$0.00</h3><div class="summary-tag">Promo / coupon</div></div>

          <div class="summary-card"><p>Total Investment</p><h3 id="sumTotalInv">$0.00</h3><div class="summary-tag">Self + team investment</div></div>
          <div class="summary-card"><p>Total Earning</p><h3 id="sumTotal">$0.00</h3><div class="summary-tag">All income total</div></div>

          <!-- ✅ NEW: Capping & Binary earning -->
          <div class="summary-card gold-border">
            <p>Capping / Binary Earning</p>
            <h3 id="sumCappingEarn">$0.00</h3>
            <div class="summary-tag">Capping used (All incomes)</div>
            <div class="summary-tag" style="margin-top:6px;">Binary Match: <span id="sumBinaryEarn">$0.00</span></div>
          </div>
        </div>

        <!-- REFERRAL -->
        <div class="ref-card">
          <div class="ref-header">
            <div>
              <h3>My Referral Link</h3>
              <span>Share this link. New members register with you as sponsor.</span>
            </div>
          </div>
          <div class="ref-body">
            <div class="ref-input"><input id="myRefLink" readonly /></div>
            <button class="ref-btn" onclick="copyRefLink()">Copy Link</button>
          </div>
        </div>

        <!-- ACTION BUTTONS -->
        <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px;">
          <button class="btn-outline-small" onclick="window.location.href='deposit.html'">Deposit</button>
          <button class="btn-outline-small" onclick="window.location.href='upgrade.html'">Upgrade / Invest</button>
          <button class="btn-outline-small" onclick="window.location.href='withdraw.html'">Withdraw</button>
        </div>

        <!-- ✅ PLAN + BINARY + RANK -->
        <div class="info-grid">
          <div class="info-card">
            <h4>Active Plan / Package</h4>
            <div class="info-row"><span>Plan Name</span><span id="planName">-</span></div>
            <div class="info-row"><span>Plan Amount</span><span id="planAmount">$0.00</span></div>
            <div class="info-row"><span>ROI % (Daily)</span><span id="planRoiPct">0%</span></div>
            <div class="info-row"><span>Daily ROI</span><span id="planDailyRoi">$0.00</span></div>
            <div class="info-row"><span>Status</span><span id="planStatus">Inactive</span></div>
            <p class="note" id="planNoteText"></p>
          </div>

          <div class="info-card">
            <h4>Binary Team (Left / Right)</h4>
            <div class="info-row"><span>Left Members</span><span id="binLeftMembers">0</span></div>
            <div class="info-row"><span>Right Members</span><span id="binRightMembers">0</span></div>
            <div class="info-row"><span>Left Business</span><span id="binLeftBusiness">$0.00</span></div>
            <div class="info-row"><span>Right Business</span><span id="binRightBusiness">$0.00</span></div>
            <div class="info-row"><span>Left Carry</span><span id="binLeftCarry">$0.00</span></div>
            <div class="info-row"><span>Right Carry</span><span id="binRightCarry">$0.00</span></div>
            <div class="info-row"><span>Matching Income</span><span id="binMatchingIncome">$0.00</span></div>
            <div class="info-row"><span>Today Match</span><span id="binTodayMatch">$0.00</span></div>
            <p class="note">Carry stays on strong side. Matching happens when both sides have volume.</p>
          </div>

          <div class="info-card">
            <h4>Rank & Target</h4>
            <div class="info-row"><span>Current Rank</span><span id="rankName">-</span></div>
            <div class="info-row"><span>Next Rank</span><span id="rankNext">-</span></div>
            <div class="info-row"><span>Target Volume</span><span id="rankTarget">$0.00</span></div>
            <div class="info-row"><span>Achieved</span><span id="rankAchieved">$0.00</span></div>
            <div class="bar-progress"><div class="bar-progress-inner" id="rankProgressInner">0%</div></div>
            <div class="info-row" style="margin-top:6px;"><span>Rank Bonus</span><span id="rankBonus">$0.00</span></div>
          </div>
        </div>

        <!-- ACCOUNT DETAILS + 2 BAROMETER -->
        <div class="info-grid">
          <div class="info-card">
            <h4>Account Details</h4>
            <div class="info-row"><span>Full Name</span><span id="accName">-</span></div>
            <div class="info-row"><span>Username</span><span id="accUser">-</span></div>
            <div class="info-row"><span>Email</span><span id="accEmail">-</span></div>
            <div class="info-row"><span>Role</span><span id="accRole">-</span></div>
          </div>

          <div class="info-card">
            <h4>Network Info</h4>
            <div class="info-row"><span>Country</span><span id="accCountry">-</span></div>
            <div class="info-row"><span>Mobile</span><span id="accMobile">-</span></div>
            <div class="info-row">
              <span>Sponsor</span>
              <span class="copy-wrap">
                <span id="accSponsor">-</span>
                <button type="button" class="copy-btn" onclick="copySponsorId()">Copy</button>
              </span>
            </div>
            <div class="info-row"><span>Joined</span><span id="accJoined">-</span></div>
          </div>

          <!-- ✅ ROI 3× BAROMETER (ROI only) -->
          <div class="info-card">
            <h4>3× ROI Return Barometer (ROI Only)</h4>

            <div class="bar-invest-grid">
              <div class="mini-invest-card"><p>Self Investment</p><h5 id="miniSelfInv">$0.00</h5></div>
              <div class="mini-invest-card"><p>Team Investment</p><h5 id="miniTeamInv">$0.00</h5></div>
              <div class="mini-invest-card"><p>Total Investment</p><h5 id="miniTotalInv">$0.00</h5></div>
            </div>

            <div class="barometer-layout">
              <div class="barometer-left">
                <div class="info-row"><span>Max Return (3×)</span><span id="barMax">$0.00</span></div>
                <div class="info-row"><span>ROI Earned</span><span id="barUsed">$0.00</span></div>
                <div class="info-row"><span>ROI Remaining</span><span id="barRemain">$0.00</span></div>
                <div class="bar-progress"><div class="bar-progress-inner" id="barProgressInner">0%</div></div>
              </div>

              <div class="bar-vertical-box">
                <span>ROI Left</span>
                <div class="bar-vertical"><div class="bar-vertical-inner" id="roiVerticalInner">0%</div></div>
                <span id="roiVerticalLabel">0% left</span>
              </div>
            </div>
          </div>

          <!-- ✅ TOTAL CAPPING BAROMETER (All incomes) -->
          <div class="info-card">
            <h4>3× Capping Barometer (All Income)</h4>
            <div class="info-row"><span>Max Cap (3×)</span><span id="capMax">$0.00</span></div>
            <div class="info-row"><span>Used (All incomes)</span><span id="capUsed">$0.00</span></div>
            <div class="info-row"><span>Remaining</span><span id="capRemain">$0.00</span></div>
            <div class="bar-progress"><div class="bar-progress-inner" id="capProgressInner">0%</div></div>
            <p class="note" id="capWarnText"></p>
          </div>
        </div>

        <!-- CHARTS -->
        <div class="charts-grid">
          <div class="chart-card">
            <h4>Income Breakdown</h4>
            <canvas id="incomeChart"></canvas>
          </div>
          <div class="chart-card">
            <h4>ROI Growth – 30 Days (demo)</h4>
            <canvas id="roiChart"></canvas>
          </div>
        </div>

        <!-- HISTORY -->
        <section class="txn-card">
          <div class="txn-header-row">
            <h4>Transaction / Income History</h4>
            <div class="txn-filter-row">
              <select id="dashTxnType">
                <option value="all">All Types</option>
                <option value="deposit">Deposit</option>
                <option value="withdraw">Withdraw</option>
                <option value="roi">ROI</option>
                <option value="sponsor">Sponsor</option>
                <option value="generation">Generation</option>
                <option value="matching">Matching</option>
                <option value="rank">Rank</option>
                <option value="global">Global</option>
                <option value="gift">Gift</option>
              </select>
              <input id="dashTxnSearch" type="text" placeholder="Search remark…" />
            </div>
          </div>

          <table class="txn-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Date / Time</th>
                <th>Type</th>
                <th>Remark</th>
                <th>Amount</th>
              </tr>
            </thead>
            <tbody id="dashTxnBody">
              <tr><td colspan="5">Loading…</td></tr>
            </tbody>
          </table>

          <p class="note">
            income_history collection থেকে সব ইনকাম/ট্রানজেকশন এখানে দেখাবে (dashboard-txn.js চালু থাকলে)।
          </p>
        </section>

        <p class="note" style="margin-top:10px;">
          ⚠ Demo UI. Live করার আগে rules + income engine + withdrawal checks ঠিকভাবে connect করতে হবে।
        </p>

      </div>
    </section>
  </div>
    <script type="module">
  import { runBinaryForAllUsers, runDailyRoiForAllUsers } from "./income-engine.js";
  </script>
  <!-- Optional: if you already have it -->
  <script type="module" src="dashboard-txn.js"></script>

  <!-- MAIN JS -->
  <script src="dashboard.js"></script>
</body>
</html>